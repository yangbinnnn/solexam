1. deploy lib.sol first and return the address
2. link lib address

# without link
$ solc --optimize --bin libtest.sol

======= lib.sol:MathLib =======
Binary: 
60a861002f600b82828239805160001a6073146000811461001f57610021565bfe5b5030600052607381538281f300730000000000000000000000000000000000000000301460806040526004361060555763ffffffff7c01000000000000000000000000000000000000000000000000000000006000350416637afbe4f18114605a575b600080fd5b60666004356024356078565b60408051918252519081900360200190f35b01905600a165627a7a723058208c56bf8ef9420b995374bf3f2a69ebfcaaf1f47f3c642c5b02fcf4d599b171750029

======= libtest.sol:LibTest =======
Binary: 
608060405234801561001057600080fd5b50610143806100206000396000f3006080604052600436106100405763ffffffff7c0100000000000000000000000000000000000000000000000000000000600035041663c29855788114610045575b600080fd5b34801561005157600080fd5b5061005a61006c565b60408051918252519081900360200190f35b604080517f7afbe4f100000000000000000000000000000000000000000000000000000000815260646004820181905260c8602483015291516000929173__lib.sol:MathLib_______________________91637afbe4f191604480820192602092909190829003018186803b1580156100e557600080fd5b505af41580156100f9573d6000803e3d6000fd5b505050506040513d602081101561010f57600080fd5b5051915050905600a165627a7a7230582003033aa5f99a3968e0be56fe215b5b76c7d3f1838420819a2d6d65421f4289620029


# with link, then placeholder "__lib.sol:MathLib_______________________" will be replaced by "692a70d2e424a56d2c6c27aa97d1a86395877b3a"
$ solc --optimize --bin libtest.sol | solc --link --libraries lib.sol:MathLib:0x692a70d2e424a56d2c6c27aa97d1a86395877b3a

======= lib.sol:MathLib =======
Binary: 
60a861002f600b82828239805160001a6073146000811461001f57610021565bfe5b5030600052607381538281f300730000000000000000000000000000000000000000301460806040526004361060555763ffffffff7c01000000000000000000000000000000000000000000000000000000006000350416637afbe4f18114605a575b600080fd5b60666004356024356078565b60408051918252519081900360200190f35b01905600a165627a7a723058208c56bf8ef9420b995374bf3f2a69ebfcaaf1f47f3c642c5b02fcf4d599b171750029

======= libtest.sol:LibTest =======
Binary: 
608060405234801561001057600080fd5b50610143806100206000396000f3006080604052600436106100405763ffffffff7c0100000000000000000000000000000000000000000000000000000000600035041663c29855788114610045575b600080fd5b34801561005157600080fd5b5061005a61006c565b60408051918252519081900360200190f35b604080517f7afbe4f100000000000000000000000000000000000000000000000000000000815260646004820181905260c8602483015291516000929173692a70d2e424a56d2c6c27aa97d1a86395877b3a91637afbe4f191604480820192602092909190829003018186803b1580156100e557600080fd5b505af41580156100f9573d6000803e3d6000fd5b505050506040513d602081101561010f57600080fd5b5051915050905600a165627a7a7230582003033aa5f99a3968e0be56fe215b5b76c7d3f1838420819a2d6d65421f4289620029


- https://solidity.readthedocs.io/en/v0.4.21/using-the-compiler.html
- https://ethereum.stackexchange.com/questions/6927/what-are-the-steps-to-compile-and-deploy-a-library-in-solidity